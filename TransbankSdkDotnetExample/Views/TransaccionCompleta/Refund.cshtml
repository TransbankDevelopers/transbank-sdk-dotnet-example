@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Reversa";
}

<div class="breadcrumbs-container">
    <div class="breadcrumbs-items">
        <a href="/">Inicio</a>
        <img src="~/t-arrow.svg" alt="t-arrow" width="24" height="24" />
    </div>
    <div class="breadcrumbs-items">
        <a href="/transaccion-completa/index">Webpay Transacción Completa</a>
        <img src="~/t-arrow.svg" alt="t-arrow" width="24" height="24" />
    </div>
    <div class="breadcrumbs-items">
        <span class="current-breadcrumb">Reversa</span>
    </div>
</div>

<h1>Transacción Completa - Reembolsar</h1>
<p class="mb-32">
    En esta etapa, tendrás la posibilidad de solicitar el reembolso del dinero al tarjeta habiente. El
    tipo de reembolso (Reversa, Anulación o Anulación parcial) dependerá del monto y el tiempo transcurrido desde la
    transacción.
</p>

<h2 id="request">Paso 1: Petición</h2>
<p class="mb-32">
    Para efectuar la solicitud de reembolso, necesitarás el token de la transacción y el monto que
    deseas reversar. Si decides anular el monto total, puede resultar en una Reversa o Anulación, según ciertas
    condiciones. En caso de un monto menor al total, se realizará una Anulación parcial. Las anulaciones parciales
    para tarjetas débito y prepago no están soportadas.
</p>
<p class="mb-32">
    En este <a class="tbk-link" href="https://www.transbankdevelopers.cl/producto/webpay#anulaciones-y-reversas" target="_blank">link</a>
    podrás ver mayor información sobre las condiciones y casos para anular o reversar transacciones.
</p>

<pre>
    <code class="language-csharp mb-32">
var tx = new FullTransaction(
    new Options(
        IntegrationCommerceCodes.TRANSACCION_COMPLETA,
        IntegrationApiKeys.WEBPAY,
        WebpayIntegrationType.Test
    )
);

var response = tx.Refund(token, amount);
    </code>
</pre>

<h2 id="response">Paso 2: Respuesta</h2>
<p class="mb-32">
    Transbank responderá con el resultado de la reversa o anulación. Evalúa cuidadosamente esta respuesta para
    confirmar que el reembolso se haya procesado de manera efectiva.
</p>

<pre><code class="language-json mb-32">@Html.Raw(ViewBag.response)</code></pre>

<div class="mt-32 mb-32">
    <a asp-controller="TransaccionCompleta" 
       asp-action="Status" 
       asp-route-token="@ViewBag.Token" 
       class="tbk-button primary">
        CONSULTAR ESTADO
    </a>
</div>
